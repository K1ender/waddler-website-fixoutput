import Callout from '@mdx/Callout.astro';
import Prerequisites from '@mdx/Prerequisites.astro';
import CodeTabs from '@mdx/CodeTabs.astro';

# Logging

<Prerequisites>
- Quick start with Waddler - [read here](/docs/get-started/mysql-new)
</Prerequisites>

To enable default query logging, just pass `{ logger: true }` to the `waddler` initialization function:
```typescript copy
import { waddler } from 'waddler/...'; // driver specific

const db = waddler({ logger: true });
```

You can also create a custom logger:
```typescript copy
import { Logger } from 'waddler';
import { waddler } from 'waddler/...'; // driver specific

class MyLogger implements Logger {
  logQuery(query: string, params: unknown[]): void {
    console.log({ query, params });
  }
}

const db = waddler({ logger: new MyLogger() });
```

## metadata

<CodeTabs items={["mysql2", "planetscale-serverless", "tidb-serverless"]}>
{/* mysql2 */}
```ts
// metadata type
type metadataType = {
  catalog: string;
  charsetNr?: number;
  db?: string;
  schema?: string;
  characterSet?: number;
  decimals: number;
  default?: any;
  flags: number | string[];
  length?: number;
  name: string;
  orgName: string;
  orgTable: string;
  protocol41?: boolean;
  table: string;
  type?: number;
  columnType?: number;
  zerofill?: boolean;
  typeName?: string;
  encoding?: string;
  columnLength?: number;
}[]

// metadata example
[
	{
		catalog: 'def',
		schema: '',
		name: '1',
		orgName: '',
		table: '',
		orgTable: '',
		characterSet: 63,
		encoding: 'binary',
		columnLength: 2,
		type: 8,
		flags: [ 'NOT NULL' ],
		decimals: 0,
		typeName: 'LONGLONG'
	}
]
```

{/* planetscale-serverless */}
```ts
// metadata type
type metadataType = {
  headers: string[];
  types: Types;
  fields: {
    name: string;
    type: string;
    table?: string;
    orgTable?: string | null;
    database?: string | null;
    orgName?: string | null;
    columnLength?: number | null;
    charset?: number | null;
    decimals?: number;
    flags?: number | null;
    columnType?: string | null;
  }[];
  size: number;
  statement: string;
  insertId: string;
  rowsAffected: number;
  time: number;
}

// metadata example
{
	headers: [ ':vtg1 /* INT64 */' ],
	types: { ':vtg1 /* INT64 */': 'INT64' },
	fields: [
	  {
	    name: ':vtg1 /* INT64 */',
	    type: 'INT64',
	    charset: 63,
	    flags: 32768
	  }
	],
	rowsAffected: 0,
	insertId: '0',
	size: 1,
	statement: 'select 1;',
	time: 1.23636
}
```

{/* tidb-serverless */}
```ts
// metadata returns only with `rowMode` equals to 'object'
type metadataType = {
  types: Record<string, string> | null;
  statement: string;
  rowCount: number | null;
  rowsAffected: number | null;
  lastInsertId: string | null;
}

// metadata example
{
	statement: 'select 1;',
	types: { '1': 'BIGINT' },
	rowsAffected: null,
	lastInsertId: null,
	rowCount: 1
}
```
</CodeTabs>